<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <title>Configuration - OS.js v2 Manual</title>
    <meta name="description" content="OS.js Manual - OS.js" />
    <meta name="keywords" content="OS.js,Documentation,Client,Server,API,Tutorial,Tutorials,Manual,Manuals" />

    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,600" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism-tomorrow.min.css">
    <link href="/css/manual.css" rel="stylesheet" />

    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="apple-touch-icon-precomposed" href="/favicon.png" />
    <link rel="author" href="https://plus.google.com/101576798387217383063" />
    <link rel="publisher" href="https://plus.google.com/101576798387217383063" />
    <link rel="canonical" href="https://manual-legacy.os-js.org/configuration" />
  </head>
  <body class="configuration">
    <header>
      <div>OS.js Manual</div>
    </header>

    <main>
      <aside id="sidebar">
        <nav>
          <ol>
            <li>
              <span>Introduction</span>
              <ul>
                <li><a href="/">About</a></li>
                <li><a href="/community">Community</a></li>
                <li><a href="/installation">Installation</a></li>
                <li><a href="/faq">FAQ</a></li>
              </ul>
            </li>

            <li>
              <span>Development</span>
              <ul>
                <li><a href="/development/#environment">Environment</a></li>
                <li><a href="/development/#contributing">Contributing</a></li>
                <li><a href="/development/#style-guide">Style guide</a></li>
              </ul>
            </li>

            <li>
              <span>Concepts</span>
              <ul>
                <li><a href="/concepts/#build-system">Build system</a></li>
                <li><a href="/concepts/#configuration-system">Configuration system</a></li>
                <li><a href="/concepts/#client">Client</a></li>
                <li><a href="/concepts/#server">Server</a></li>
                <li><a href="/concepts/#modules">Modules</a></li>
                <li><a href="/concepts/#packages">Packages</a></li>
                <li><a href="/concepts/#overlays">Overlays</a></li>
              </ul>
            </li>

            <li>
              <span>Configuration</span>
              <ul>
                <li><a href="/configuration/">General</a></li>
                <li><a href="/configuration/#webpack">Webpack</a></li>
                <li><a href="/configuration/connection">Connection</a></li>
                <li><a href="/configuration/authenticator">Authenticator</a></li>
                <li><a href="/configuration/storage">Storage</a></li>
                <li><a href="/configuration/vfs">VFS</a></li>
              </ul>
            </li>

            <li>
              <span>Packages</span>
              <ul>
                <li><a href="/packages">Introduction</a></li>
                <li><a href="/packages/scheme">Using Scheme</a></li>
                <li><a href="/packages/vue">Using Vue</a></li>
                <li><a href="/packages/react">Using React</a></li>
                <li><a href="/packages/iframe">Using IFrame</a></li>
              </ul>
            </li>

            <li>
              <span>Guides</span>
              <ul>
                <li><a href="/guides/authenticator">Authenticator</a></li>
                <li><a href="/guides/storage">Storage</a></li>
                <li><a href="/guides/transport">VFS Transport</a></li>
                <li><a href="/guides/middleware">Middleware</a></li>
                <li><a href="/guides/service">Service</a></li>
                <li><a href="/guides/themes">Themes</a></li>
                <li><a href="/guides/responsive">Responsiveness</a></li>
                <li><a href="/guides/misc">Misc</a></li>
              </ul>
            </li>

          </ol>

        </nav>
      </aside>

      <content>
        <div style="padding:1em;margin-bottom:2em;background-color:#e6e6e6;font-size:1.5em;font-weight:bold">
          OS.js v2 has been deprecated.
          Head over to <a href="https://manual.os-js.org/">https://manual.os-js.org/</a> for the latest v3 manual.
        </div>
        <h1 id="configuration">Configuration</h1>
<p><em>Remember to regenerate configurations if you change anything with <code>node osjs build:config</code>, and restart your server (if applicable).</em></p>
<p>This is a list of tasks to interact with the configuration files:</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Set a configuration entry</span>
$ <span class="token function">node</span> osjs config:set --name<span class="token operator">=</span>key --value<span class="token operator">=</span>val

<span class="token comment"># Show a configuration entry</span>
$ <span class="token function">node</span> osjs config:get --name<span class="token operator">=</span>key

<span class="token comment"># Import from file</span>
$ <span class="token function">node</span> osjs config:set --import<span class="token operator">=</span>FILENAME

<span class="token comment"># Using a variable</span>
$ <span class="token function">node</span> osjs config:set --name<span class="token operator">=</span>foo --value<span class="token operator">=</span>bar
$ <span class="token function">node</span> osjs config:set --name<span class="token operator">=</span>foobar --value<span class="token operator">=</span><span class="token string">&quot;%foo%baz&quot;</span> <span class="token comment"># Results in &quot;barbaz&quot;</span>

<span class="token comment"># Customize output file (defaults to 900-custom.json)</span>
$ <span class="token function">node</span> osjs config:set --name<span class="token operator">=</span>foo --value<span class="token operator">=</span>bar --out<span class="token operator">=</span>src/config/910-something.json

<span class="token comment"># You can also add and remove from arrays</span>
$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>foo --value<span class="token operator">=</span>jazz
$ <span class="token function">node</span> osjs config:remove --name<span class="token operator">=</span>foo --value<span class="token operator">=</span>jazz

<span class="token comment"># ...or objects</span>
$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>foo --key<span class="token operator">=</span>bar --value<span class="token operator">=</span>jazz
$ <span class="token function">node</span> osjs config:remove --name<span class="token operator">=</span>foo --key<span class="token operator">=</span>bar
</code></pre>
<h2 id="general">General</h2>
<h3 id="adding-overlays">Adding overlays</h3>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>overlays --value<span class="token operator">=</span>overlays/foo
$ <span class="token function">node</span> osjs build
</code></pre>
<h3 id="adding-packages">Adding packages</h3>
<p>This should give you an idea of how to add your own packages into a group:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">mkdir</span> src/packages/mypackages
$ <span class="token function">git</span> clone <span class="token operator">&lt;</span>repo<span class="token operator">&gt;</span> src/packages/mypackages/repo
$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>repositories --value<span class="token operator">=</span>mypackages
$ <span class="token function">node</span> osjs build:manifest
$ <span class="token function">node</span> osjs build:packages --repository<span class="token operator">=</span>mypackages
</code></pre>
<h3 id="toggling-packages">Toggling packages</h3>
<p>You can also cherry-pick what packages to use:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>packages.ForceEnable --value<span class="token operator">=</span>repo/name
$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>packages.ForceDisable --value<span class="token operator">=</span>repo/name
</code></pre>
<h3 id="adding-preloads">Adding preloads</h3>
<p>You can add preload files instead of bundling them with Webpack:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>client.Preloads --key<span class="token operator">=</span>something --value<span class="token operator">=</span>filename.js

</code></pre>
<h3 id="changing-base-template">Changing base template</h3>
<p>To change the base template, simply copy the default folder and change the configuration entry:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">cp</span> src/templates/dist/default src/templates/dist/mytemplate
$ <span class="token function">node</span> osjs config:set --name<span class="token operator">=</span>build.template --value<span class="token operator">=</span>mytemplate
</code></pre>
<h3 id="setting-session-secret">Setting session secret</h3>
<p>Example:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">node</span> osjs config:set --name<span class="token operator">=</span>server.http.session.secret --value<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /dev/urandom <span class="token operator">|</span> <span class="token function">tr</span> -dc <span class="token string">&apos;a-zA-Z0-9&apos;</span> <span class="token operator">|</span> <span class="token function">fold</span> -w <span class="token number">32</span> <span class="token operator">|</span> <span class="token function">head</span> -n <span class="token number">1</span><span class="token variable">)</span></span>
</code></pre>
<h3 id="add-permission-to-api-endpoint">Add permission to API endpoint</h3>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>server.api.groups --key<span class="token operator">=</span>methodname --value<span class="token operator">=</span>groupname
</code></pre>
<h3 id="add-permission-group-to-vfs-mountpoint">Add permission group to VFS mountpoint</h3>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">node</span> osjs config:add --name<span class="token operator">=</span>server.vfs.groups --key<span class="token operator">=</span>mountname --value<span class="token operator">=</span>groupname
</code></pre>
<h2 id="webpack">Webpack</h2>
<h3 id="core-builds">Core builds</h3>
<p>Look at <code>src/conf/500-build.json</code> for the base webpack configuration tree.</p>
<p>This is loaded into <code>src/client/webpack.config.js</code> with some modifications.</p>
<p>This also applies to the theme build in <code>src/themes/webpack.config.js</code>.</p>
<pre class="language-javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  osjs<span class="token punctuation">.</span>webpack<span class="token punctuation">.</span><span class="token function">createCoreConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token comment">// result.config - Webpack configuration</span>
    <span class="token comment">// result.settings - OS.js settings tree</span>
    <span class="token comment">// result.options - Options from launcher</span>

    <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="package-builds">Package builds</h3>
<p>Packages have their own <code>webpack.config.js</code>, but does not inherit any of the configuration mentioned above.</p>
<pre class="language-javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> metadataFile <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&apos;metadata.json&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  osjs<span class="token punctuation">.</span>webpack<span class="token punctuation">.</span><span class="token function">createPackageConfiguration</span><span class="token punctuation">(</span>metadataFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token comment">// result.config - Webpack configuration</span>
    <span class="token comment">// result.settings - OS.js settings tree</span>
    <span class="token comment">// result.options - Options from launcher</span>

    <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

      </content>
    </main>

    <footer>
      <div class="adddshere">
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- https://os.js.org (RESPONSIVE) -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-6145716264521226"
             data-ad-slot="9888011596"
             data-ad-format="auto"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>

      <p>OS.js &copy; Anders Evenrud 2011-2017</p>
      <p>Generated with Metalsmith</p>
    </footer>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-90971004-7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-90971004-7');
    </script>

    <script>
      ((window.gitter = {}).chat = {}).options = {
        room: 'os-js/OS.js'
      };
    </script>
    <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

    <script>
document.getElementById('Search').onsubmit = function(ev) {
  ev.preventDefault();

  var v = document.getElementById('SearchQuery').value;
  var q = 'site:os.js.org ' + encodeURIComponent(String(v));
  window.location = 'https://google.com/search?q=' + q;

  return false;
};
    </script>

  </body>
</html>
